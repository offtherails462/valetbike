<style media="screen">
  .navbar-collapse {
    backgound-color: #f8f9fa;
  }

  .nav-item {
    text-size: 12pt;
  }

  nav {
    opacity: 0.8;
  }

  .full-opacity {
    opacity: 1;
  }

  .navbar.navbar-custom .navbar-toggle {
    border-color: transparent;
  }
  @media (max-width: 767px) {
    .navbar.navbar-custom .navbar-collapse,
    .navbar.navbar-custom .navbar-form {
      border-color: rgb(222, 145, 139);
      background-color: #212529;
      opacity: 1;
    }
  }
</style>

<!-- Partial ERB for the site navbar -->
<nav class="navbar fixed-top navbar-custom navbar-expand-lg bg-dark navbar-dark p-md-3 shadow">
  <div class="container-fluid">
    <%= link_to("ValetBike", root_path, class: 'navbar-brand') %>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <!-- Main links -->
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <%= link_to("How it Works", how_it_works_index_path, class: 'nav-item nav-link') %>
        </li>
        <li class="nav-item">
          <%= link_to("Subscription Plans", checkout_path, class: 'nav-item nav-link') %>
        </li>
        <li class="nav-item">
          <%= link_to("Find a Bike", stations_path, class: 'nav-item nav-link') %>
        </li>
      </ul>

      <!-- User management section -->
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <span class="navbar-text" href="#">
          Hello, <%= Current.user ? Current.user.first_name : 'guest' %>!
        </span>
        <% if Current.user %>
          <div class="user-section">
            <a><i class="fa fa-compass"></i></a>
          </div>
          <li>
            <%= link_to("Edit Profile", users_edit_path, class: 'nav-item nav-link') %>
          </li>
          <li class="nav-item">
            <%= button_to("Log out", logout_path, method: :delete, class: 'nav-item btn btn-primary') %>
          </li>
        <% else %>
          <li>
            <%= link_to("Log in", login_path, class: 'nav-item nav-link') %>
          </li>
          <li>
            <%= link_to("Sign up", signup_path, class: 'nav-item nav-link') %>
          </li>
        <% end %>
      </ul>

      <!-- Javascript code to make dropdown for navbar accessible -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

      <!-- Javascript code to get navbar to have a white backgound when scrolling -->
      <script>
        var nav = document.querySelector('nav');

        window.addEventListener('scroll', function(){
          if(window.pageYOffset > 10){
            nav.classList.add('full-opacity');
          } else {
            nav.classList.remove('full-opacity');
          }
        })
      </script>
      <script>
        document.addEventListener("DOMContentLoaded", function(){
          navbar_height = document.querySelector('.navbar').offsetHeight; //get the offset height
          document.body.style.paddingTop = navbar_height + 'px'; // Add the offset height to the top padding
        });
      </script>

    </div>
  </div>
</nav>
